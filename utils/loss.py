import torch
import torch.nn as nn
import torch.nn.functional as F


class ShannonEntropyLoss(nn.Module):
    def __init__(self):
        super(ShannonEntropyLoss, self).__init__()

    def forward(self, x):
        H = torch.exp(x) * x
        H = -1.0 * H.sum()
        return H


class RenyiEntropyLoss(nn.Module):
    def __init__(self):
        super(RenyiEntropyLoss, self).__init__()

    def forward(self, x):
        return -1.0 * torch.log(torch.pow(torch.exp(x), 2).sum())


class ContrastiveLoss(nn.Module):
    def __init__(self, margin=2.0):
        super(ContrastiveLoss, self).__init__()
        self.margin = margin

    def forward(self, d, label):
        losses = (1 - label.float()) * torch.pow(d, 2) + \
            label.float() * torch.pow(torch.clamp(self.margin - d, min=0.0), 2)
        return losses.mean()


class SeparationLoss(nn.Module):
    def __init__(self, margin=1.0):
        super(SeparationLoss, self).__init__()
        self.margin = margin

    def forward(self, d):
        losses = torch.pow(torch.clamp(self.margin - d, min=0.0), 2)
        return losses.mean()
